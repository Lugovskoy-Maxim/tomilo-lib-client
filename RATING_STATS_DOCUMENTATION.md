# Документация: Статистика рейтингов тайтла

## Обзор

Добавлена функциональность отображения статистики рейтингов на странице тайтла согласно требованиям задачи.

## Изменения

### 1. Обновлен интерфейс Title (src/types/title.ts)

Добавлены новые поля для работы с рейтингами:
```typescript
// Поля для рейтингов
totalRatings?: number; // Общее количество оценок
ratings?: number[]; // Массив всех оценок [10, 9, 8, 10, ...]
```

Добавлен новый интерфейс для статистики рейтингов:
```typescript
// Тип для статистики рейтингов
export interface RatingStat {
  rating: number;
  count: number;
  percentage: string;
}
```

### 2. Обновлен компонент RightContent (src/shared/browse/title-view/right-content.tsx)

#### Функция обработки статистики
```typescript
const getRatingStats = (ratings: number[]) => {
  const stats = ratings.reduce((acc, rating) => {
    acc[rating] = (acc[rating] || 0) + 1;
    return acc;
  }, {} as Record<number, number>);

  return Object.entries(stats)
    .map(([rating, count]) => ({
      rating: parseInt(rating),
      count,
      percentage: (count / ratings.length * 100).toFixed(1)
    }))
    .sort((a, b) => b.rating - a.rating);
};
```

#### Отображение общего количества оценок
Рядом с средней оценкой теперь показывается общее количество оценок:
```
9.2
(15 оценок)
```

#### Статистика в разделе "Статистика"
В разделе статистики тайтла добавлено:

1. **Общее количество оценок**: Показывает общее количество всех оценок
2. **Распределение оценок**: Показывает статистику по типам оценок в формате:
   - 10 ★ - 8 шт (44.4%)
   - 9 ★ - 2 шт (11.1%)
   - 8 ★ - 5 шт (27.8%)
   - 7 ★ - 3 шт (16.7%)

Каждая строка содержит:
- Оценку (число от 1 до 10)
- Иконку звезды
- Прогресс-бар показывающий процент
- Количество оценок и процентное соотношение

## Формат данных

### Входные данные
```javascript
{
  "ratings": [10, 9, 8, 10, 9, 10, 8, 9, 7, 10, 9, 8, 10, 9, 8, 7, 10, 9],
  "totalRatings": 18
}
```

### Результат обработки
```typescript
[
  { rating: 10, count: 6, percentage: "33.3" },
  { rating: 9, count: 5, percentage: "27.8" },
  { rating: 8, count: 4, percentage: "22.2" },
  { rating: 7, count: 2, percentage: "11.1" },
  { rating: 6, count: 1, percentage: "5.6" }
]
```

## Особенности реализации

1. **Безопасность**: Функция корректно обрабатывает пустые массивы
2. **Сортировка**: Результаты сортируются по убыванию оценки (10, 9, 8...)
3. **Проценты**: Процентные значения округляются до одного знака после запятой
4. **UI/UX**: Прогресс-бары и иконки звезд улучшают визуальное восприятие
5. **Условное отображение**: Статистика показывается только если есть оценки

## Тестирование

Функциональность была протестирована с различными наборами данных:
- Полный набор оценок
- Пустой массив
- Один тип оценок

Все тесты прошли успешно, функция корректно обрабатывает различные сценарии использования.

## Совместимость

Изменения не нарушают существующую функциональность:
- Все поля остаются опциональными
- Обратная совместимость с существующими данными
- Постепенное внедрение возможно без breaking changes
